<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Generator</title>
    <style>
        .dark-mode {
            background-color: #333;
            color: #eee;
        }
    </style>
</head>
<body>
    <select id="codeSelect" onchange="toggleInputs()">
        <option value="selectCode">Select Code</option>
        <option value="code2">Code 2</option>
        <option value="code3">Code 3</option>
        <option value="code4">Code 4</option>
        <option value="code5">Code 5</option>
    </select>

    <div id="additionalInputsRevCat" style="display: none;">
        <!-- Add any additional inputs for code1 related features here if needed -->
    </div>

    <div id="additionalInputsOther" style="display: none;">
        <label for="containsString1">Contains String 1:</label>
        <input type="text" id="containsString1"><br>
        <label for="containsString2">Contains String 2:</label>
        <input type="text" id="containsString2"><br>
    </div>

    <div id="userCode" style="display: none;">
        <label for="userCodeInput">User Code:</label>
        <textarea id="userCodeInput"></textarea>
    </div>

    <button id="genBtn" style="display: none;" onclick="generateScript()">Generate Script</button>

    <button id="darkModeToggle">Dark Mode</button>

    <pre id="highlightCode"></pre>

    <script>
        function toggleInputs() {
            var selectElement = document.getElementById('codeSelect');
            var additionalInputsRevCat = document.getElementById('additionalInputsRevCat');
            var userCodeInput = document.getElementById('userCode');
            var generateButton = document.getElementById('genBtn');
            var additionalInputsOther = document.getElementById('additionalInputsOther');

            generateButton.style.display = 'block';

            if (selectElement.value === 'selectCode') {
                additionalInputsOther.style.display = 'none';
                additionalInputsRevCat.style.display = 'none';
                userCodeInput.style.display = 'none';
                generateButton.style.display = 'none';
            } else if (selectElement.value === 'code2' || selectElement.value === 'code3' || selectElement.value === 'code4') {
                additionalInputsRevCat.style.display = 'none';
                additionalInputsOther.style.display = 'block';
                userCodeInput.style.display = 'block';
            } else {
                additionalInputsRevCat.style.display = 'none';
                userCodeInput.style.display = 'block';
            }
        }

        function generateScript() {
            var selectedCode = document.getElementById('codeSelect').value;
            var userCode = document.getElementById('userCodeInput').value.trim();
            var entValue = document.getElementById('entitlement') ? document.getElementById('entitlement').value.trim() : '';
            var prodIDValue = document.getElementById('productID') ? document.getElementById('productID').value.trim() : '';
            var containsStringOne = document.getElementById('containsString1').value.trim();
            var containsStringTwo = document.getElementById('containsString2').value.trim();

            var highlightCode = '';

            // Define existing codes
            var code2 = 
            `#import <Foundation/Foundation.h>

            %hook AFURLSessionManager
            // Generated using DCG by D3WXY
            -(void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)task didReceiveData:(NSData *)data {
            if ([task.currentRequest.URL.absoluteString containsString:@"${containsStringOne}"]) {
            NSDictionary *dict = "User Code HERE"


            // Generated using DCG by D3WXY
            data = [NSJSONSerialization dataWithJSONObject:dict options:0 error:0];
            }
            // Generated using DCG by D3WXY
            %orig(session, task, data);
            }
            // Generated using DCG by D3WXY
            %end`;

            var code3 = 
            `#import <Foundation/Foundation.h>

            %hook SessionDelegate
            // Generated using DCG by D3WXY
            -(void)URLSession:(NSURLSession *)session dataTask:(NSURLSessionDataTask *)task didReceiveData:(NSData *)data {
            if ([task.currentRequest.URL.absoluteString containsString:@"${containsStringOne}"]) {
            NSDictionary *dict = "User Code HERE"


            // Generated using DCG by D3WXY
            data = [NSJSONSerialization dataWithJSONObject:dict options:0 error:0];
            }
            %orig(session, task, data);
            }
            // Generated using DCG by D3WXY
            %end

            %ctor {
            %init(SessionDelegate = objc_getClass("Alamofire.SessionDelegate"));
            }`;

            var code4 = 
            `#import <Foundation/Foundation.h>

            %hook HttpAsynConnection
            // Generated using DCG by D3WXY
            - (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
            NSURLRequest *originalRequest = [connection originalRequest];
            NSString *urlString = [[originalRequest URL] absoluteString];
            // Generated using DCG by D3WXY
            if ([urlString containsString:@"${containsStringOne}"]) {
            NSDictionary *dict = "User Code HERE"


            // Generated using DCG by D3WXY
            NSError *error = nil;
            NSData *modifiedData = [NSJSONSerialization dataWithJSONObject:dict options:0 error:&error];
            if (!error) {
            %orig(connection, modifiedData);
            } else {
            %orig(connection, data);
            }
            } else {
            %orig(connection, data);
            }
            }
            // Generated using DCG by D3WXY
            %end`;

            var code5 = `There isn't another template, if you have one. DM me (@D3WXY) on Telegram`;

            // Select the appropriate code based on the user's selection
            switch(selectedCode) {
                case 'code2':
                    highlightCode = code2;
                    break;
                case 'code3':
                    highlightCode = code3;
                    break;
                case 'code4':
                    highlightCode = code4;
                    break;
                case 'code5':
                    highlightCode = code5;
                    break;
                default:
                    highlightCode = ''; // Handle default case
            }

            // Merge user's code with selected code
            highlightCode = highlightCode.replace('"User Code HERE"', userCode);
            highlightCode = highlightCode.replace('${entValue}', entValue);
            highlightCode = highlightCode.replace('${prodIDValue}', prodIDValue);

            document.getElementById('highlightCode').textContent = highlightCode;

            // Copy the generated script to the clipboard
            navigator.clipboard.writeText(highlightCode).then(function () {
                console.log('Script copied to clipboard');
            }, function (err) {
                console.error('Failed to copy script: ', err);
            });
        }

        // Check if dark mode preference is stored
        const isDarkMode = localStorage.getItem('darkMode') === 'true';

        // Function to set dark mode based on preference
        function setDarkMode() {
            const body = document.body;
            const darkModeToggle = document.getElementById('darkModeToggle');

            if (isDarkMode) {
                body.classList.add('dark-mode');
                darkModeToggle.textContent = 'Light Mode';
            } else {
                body.classList.remove('dark-mode');
                darkModeToggle.textContent = 'Dark Mode';
            }
        }

        // Toggle dark mode and save user preference
        function toggleDarkMode() {
            const body = document.body;
            const darkModeToggle = document.getElementById('darkModeToggle');

            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                darkModeToggle.textContent = 'Light Mode';
                localStorage.setItem('darkMode', 'true');
            } else {
                darkModeToggle.textContent = 'Dark Mode';
                localStorage.setItem('darkMode', 'false');
            }
        }

        // Call setDarkMode function to apply preference on page load
        setDarkMode();

        // Add event listener to dark mode toggle button
        document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);
    </script>
</body>
</html>